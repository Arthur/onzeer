#player

.album
  %span.artist
    =h @album.artist
  %span.album_name
    =h @album.name

  .tracks.playable
    %ul
      = render :partial => "tracks/track", :collection => @album.tracks

  = javascript_tag "var tracks = #{@album.tracks.to_json};"

  %ul.links
    - if @album.musicbrainz_release_id
      %li.musicbrainz
        = link_to "MusicBrainz.org", "http://musicbrainz.org/release/#{@album.musicbrainz_release_id}.html"
  
    - if @album.amazon_asin
      %li.amazon{:class => "asin_#{@album.amazon_asin}"}
        = link_to "Amazon", "http://www.amazon.fr/gp/product/#{@album.amazon_asin}"

  %ul.votes
    %li.lovers
      %h4
        Lovers
      %ul
        - @album.lovers.each do |account|
          %li
            =h(account.nickname)
        - unless @album.lovers.include?(current_user)
          %li.me
            - form_for :vote, :url => like_album_path(@album) do |f|
              = f.submit "I like it !"
    %li.haters
      %h4
        Haters
      %ul
        - @album.haters.each do |account|
          %li
            = h(account.nickname)
        - unless @album.haters.include?(current_user)
          %li.me
            - form_for :vote, :url => hate_album_path(@album) do |f|
              = f.submit "I hate it !"

  .comments
    %h3 Commentaires
    %ul.comments
      - @album.comments.each do |comment|
        %li
          %p.body
            =h(comment.body)
          %p.author
            =h(comment.author.nickname)
          / %p.date
          /   =h(comment.created_at)
          - if comment.author == current_user
            %p.edit
              = link_to "edit", edit_album_comment_path(@album, comment)
    .new
      = link_to "add a comment", new_album_comment_path(@album)
  